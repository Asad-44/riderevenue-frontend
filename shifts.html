<!doctype html>
<html>
<head><meta charset="utf-8"><title>Shifts</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet"></head>
<body class="bg-light">
<div class="container py-4">
  <a href="dashboard.html" class="btn btn-link">‚Üê Back</a>
  <h3>Shifts</h3>
  <form id="fs" class="mb-3">
    <div class="row g-2">
      <div class="col-md-3"><select id="dsel" name="driverId" class="form-select" required></select></div>
      <div class="col-md-2"><input name="date" type="date" class="form-control" required></div>
      <div class="col-md-3"><input name="startTime" class="form-control" placeholder="Start (YYYY-MM-DD HH:MM) e.g. 2025-11-29 08:00" required></div>
      <div class="col-md-3"><input name="endTime" class="form-control" placeholder="End (optional)"></div>
      <div class="col-md-1"><button class="btn btn-primary">Add</button></div>
    </div>
  </form>
  <div id="list"></div>
</div>
<script>
if(!localStorage.token) location='login.html';
const api = 'https://riderevenue-backend.onrender.com/api';
const headers={ 'Content-Type':'application/json','Authorization':'Bearer '+localStorage.token };
async function loadDrivers(){ const d=await (await fetch(api+'/drivers',{headers})).json(); document.getElementById('dsel').innerHTML = d.map(x=>`<option value="${x.DriverID}">${x.Name}</option>`).join(''); }
document.getElementById('fs').addEventListener('submit', async e=>{ e.preventDefault(); const f=e.target; const body={ driverId: parseInt(f.driverId.value), date: f.date.value, startTime: f.startTime.value, endTime: f.endTime.value||null }; const res=await fetch(api+'/shifts',{method:'POST',headers,body:JSON.stringify(body)}); if(res.ok){ load(); f.reset(); } else alert((await res.json()).message); });
async function load(){ const data=await (await fetch(api+'/shifts',{headers})).json(); document.getElementById('list').innerHTML = `<table class="table"><thead><tr><th>Date</th><th>Driver</th><th>Start</th><th>End</th><th>Hours</th></tr></thead><tbody>${data.map(s=>`<tr><td>${s.Date}</td><td>${s.DriverName}</td><td>${s.StartTime}</td><td>${s.EndTime||''}</td><td>${s.TotalHours}</td></tr>`).join('')}</tbody></table>`; }
loadDrivers(); load();
</script>
</body>
</html>
